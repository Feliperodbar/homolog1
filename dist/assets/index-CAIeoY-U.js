(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}})();const s={start:document.getElementById("startCaptureBtn"),stop:document.getElementById("stopCaptureBtn"),add:document.getElementById("addStepBtn"),toggleExpand:document.getElementById("toggleExpandBtn"),downloadHtml:document.getElementById("downloadHtmlBtn"),downloadDocx:document.getElementById("downloadDocxBtn"),clear:document.getElementById("clearStepsBtn"),video:document.getElementById("screenVideo"),videoWrapper:document.getElementById("videoWrapper"),overlay:document.getElementById("videoOverlay"),steps:document.getElementById("stepsList"),toast:document.getElementById("toast"),imageModal:document.getElementById("imageModal"),modalImage:document.getElementById("modalImage"),status:document.getElementById("statusText")};let C=null,f=[];const K="homolog_steps_v1",W=20.23,j=9.28,ue=7,pe=10,Q=window.matchMedia("(prefers-reduced-motion: reduce)");function Z(e){const n=!!e.matches;document.documentElement.setAttribute("data-reduced-motion",n?"true":"false")}Z(Q);try{Q.addEventListener("change",Z)}catch{}function m(e,n=1600){s.toast&&(s.toast.textContent=e,s.toast.classList.remove("hidden"),setTimeout(()=>s.toast.classList.add("hidden"),n))}function ee(e){s.status&&(s.status.textContent=e)}async function me(){try{C=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always",preferCurrentTab:!0},audio:!1});const e=C.getVideoTracks()[0];e.onended=()=>{te()},s.video.srcObject=C,await G(),s.overlay.classList.remove("hidden"),ee("Capturando tela"),m("Captura iniciada");try{window.focus()}catch{}setTimeout(()=>{try{window.focus()}catch{}},50)}catch(e){console.error("Erro ao iniciar captura:",e),m("Não foi possível iniciar a captura")}}function te(){C&&(C.getTracks().forEach(e=>e.stop()),C=null,s.video.srcObject=null,s.overlay.classList.add("hidden"),ee("Pronto"),m("Captura finalizada"),document.fullscreenElement&&document.exitFullscreen())}function ne(e){const n=s.video;if(!n||!n.videoWidth||!n.videoHeight)return m("Vídeo indisponível para captura"),null;const t=n.videoWidth,o=n.videoHeight,a=document.createElement("canvas");a.width=t,a.height=o;const r=a.getContext("2d");if(r.drawImage(n,0,0,t,o),e&&typeof e.x=="number"&&typeof e.y=="number"){const d=Math.max(18,Math.round(Math.min(t,o)*.025));Te(r,e.x,e.y,d)}return a.toDataURL("image/png",.9)}async function G(){const e=s.video;if(e&&!(e.readyState>=2&&e.videoWidth&&e.videoHeight)){await new Promise(n=>e.addEventListener("loadedmetadata",n,{once:!0}));try{await e.play()}catch{}}}function U(){try{localStorage.setItem(K,JSON.stringify(f))}catch(e){console.warn("Persistência falhou:",e)}}function ge(){try{const e=localStorage.getItem(K);e&&(f=JSON.parse(e)||[])}catch{}}async function oe(){if(!C){m("Inicie a captura para criar passos");return}await G();const e=ne();if(!e){m("Não foi possível capturar a tela");return}const n={id:`step_${Date.now()}`,title:`Passo #${f.length+1} — ${new Date().toLocaleString("pt-BR")}`,description:"Passo manual. Descreva a ação realizada, o objetivo e o resultado esperado.",imageDataUrl:e,createdAt:Date.now()};f.push(n),H(),U(),m("Passo adicionado")}function he(e){f=f.filter(n=>n.id!==e),H(),U()}function R(e,n,t){const o=f.findIndex(a=>a.id===e);o>=0&&(f[o][n]=t,U())}function fe(){f=[],H(),U()}function H(){if(s.steps.innerHTML="",!f.length){const e=document.createElement("div");e.className="hint",e.textContent="Nenhum passo ainda. Capture a tela e adicione passos.",s.steps.appendChild(e);return}for(const e of f){const n=document.createElement("div");n.className="step-card";const t=document.createElement("img");t.className="step-thumb",t.src=e.imageDataUrl,t.alt=e.title||"Passo",t.addEventListener("click",()=>Ie(e.imageDataUrl));const o=document.createElement("div");o.className="step-fields";const a=document.createElement("label");a.textContent="Título";const r=document.createElement("input");r.type="text",r.value=e.title||"",r.addEventListener("input",y=>R(e.id,"title",y.target.value));const c=document.createElement("label");c.textContent="Descrição";const d=document.createElement("textarea");d.value=e.description||"",d.addEventListener("input",y=>R(e.id,"description",y.target.value));const u=document.createElement("label");u.textContent="Item clicado";const i=document.createElement("input");i.type="text",i.value=e.tag||"",i.placeholder='Texto visível do item clicado (ex.: "Salvar", "Menu Home").',i.addEventListener("input",y=>R(e.id,"tag",y.target.value)),o.appendChild(a),o.appendChild(r),o.appendChild(u),o.appendChild(i),o.appendChild(c),o.appendChild(d);const p=document.createElement("div");p.className="step-actions";const w=document.createElement("button");w.textContent="Excluir",w.className="danger",w.addEventListener("click",()=>he(e.id)),p.appendChild(w),n.appendChild(t),n.appendChild(o),n.appendChild(p),s.steps.appendChild(n)}}function B(e){return String(e).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function we(){const n=W,t=j,o=f.map((r,c)=>{const d=B(r.title||`Passo ${c+1}`),u=B(r.description||""),i=B(r.tag||""),p=r.imageDataUrl||"";return`<article style="border:none;border-radius:6px;padding:10px;background:#fafafa;margin:10px 0;">
      <header>
        <h3 style="margin:0 0 6px;color:#111827;font-family:system-ui,Segoe UI,Roboto">${d}</h3>
        ${i?`<p style="margin:0 0 8px;color:#374151;font-size:12px">Item clicado: ${i}</p>`:""}
      </header>
      ${p?`<img src="${p}" alt="${d}" style="display:block;margin:6px auto;width:${n}cm;height:auto;max-height:${t}cm;border:none;border-radius:6px;object-fit:contain">`:""}
      ${u?`<p style="margin:8px 0;color:#1f2937">${u}</p>`:""}
    </article>`}).join("");return`<!doctype html><html lang="pt-BR"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>${B("")}</title>
    <style>
      body{font-family:ui-sans-serif,system-ui,Segoe UI,Roboto;background:#ffffff;color:#111827;margin:20px}
      .docx-container{width:${n}cm;margin:0 auto}
      h1{font-size:20px;margin:0 0 12px}
      .hint{color:#6b7280;font-size:12px;margin-bottom:12px}
      .layout-header{margin:6px 0 14px}
      .brand{display:flex;align-items:center;gap:8px;margin-bottom:6px}
      .brand-logo{height:20px}
      .brand-name{display:none}
      .meta-table{width:100%;border-collapse:collapse;font-size:12px;border:none}
      .meta-table th,.meta-table td{border:none;padding:6px;vertical-align:top}
    </style>
  </head><body>
    <div class="docx-container">
      <div class="layout-header">
        <div class="brand">
          <img src="./assets/headerneo.JPG" alt="Header" style="width:100%;height:auto;border-radius:6px"/>
        </div>
        <table class="meta-table">
          <tr>
            <td><strong>Projeto:</strong> <span contenteditable="true"></span></td>
            <td><strong>Frente:</strong> <span contenteditable="true"></span></td>
          </tr>
          <tr>
            <td><strong>Distribuidora:</strong> <span contenteditable="true"></span></td>
            <td><strong>Responsável:</strong> <span contenteditable="true"></span></td>
          </tr>
          <tr>
            <td><strong>Produto/Serviço:</strong> <span contenteditable="true"></span></td>
            <td><strong>Data:</strong> <span contenteditable="true"></span></td>
          </tr>
          <tr>
            <td><strong>Resultado Esperado:</strong> <span contenteditable="true"></span></td>
            <td><strong>Versão:</strong> <span contenteditable="true"></span> &nbsp; | &nbsp; <strong>Navegador:</strong> <span contenteditable="true"></span></td>
          </tr>
        </table>
      </div>
      <section>
        
        ${o||"<p>Nenhum passo.</p>"}
      </section>
    </div>
    </body></html>`}async function be(e){return await(await(await fetch(e)).blob()).arrayBuffer()}async function ye(e){const t=await(await fetch(e)).blob();return await new Promise((o,a)=>{const r=new FileReader;r.onload=()=>o(r.result),r.onerror=a,r.readAsDataURL(t)})}function xe(e){return new Promise(n=>{const t=new Image;t.onload=()=>n({width:t.naturalWidth||t.width||1920,height:t.naturalHeight||t.height||1080}),t.onerror=()=>n({width:1920,height:1080}),t.src=e})}async function ve(){try{if(!window.docx)return ae();const{Document:e,Packer:n,Paragraph:t,TextRun:o,ImageRun:a,Table:r,TableRow:c,TableCell:d,Header:u}=window.docx,i=window.docx||{},p=new Date,w="",y=W,T=j,g=x=>Math.round(x/2.54*96),h=[];let b=null;try{const x="./assets/headerneo.JPG",v=await(await fetch(x)).arrayBuffer(),M=await xe(x),I=g(y),F=Math.min(I,M.width||I),N=M.width?F/M.width:1,k=Math.round((M.height||I)*N);b=new a({data:v,transformation:{width:F,height:k}})}catch{}const L=[new c({children:[new d({children:[new t({children:[new o({text:"Projeto:",bold:!0}),new o({text:" "})]})]}),new d({children:[new t({children:[new o({text:"Frente:",bold:!0}),new o({text:" "})]})]})]}),new c({children:[new d({children:[new t({children:[new o({text:"Distribuidora:",bold:!0}),new o({text:" "})]})]}),new d({children:[new t({children:[new o({text:"Responsável:",bold:!0}),new o({text:" "})]})]})]}),new c({children:[new d({children:[new t({children:[new o({text:"Produto/Serviço:",bold:!0}),new o({text:" "})]})]}),new d({children:[new t({children:[new o({text:"Data:",bold:!0}),new o({text:" "})]})]})]}),new c({children:[new d({children:[new t({children:[new o({text:"Resultado Esperado:",bold:!0}),new o({text:" "})]})]}),new d({children:[new t({children:[new o({text:"Versão:",bold:!0}),new o({text:" "}),new o({text:"  |  Navegador:",bold:!0}),new o({text:" "})]})]})]})],O=[...b?[new t({alignment:i.AlignmentType?i.AlignmentType.CENTER:void 0,children:[b]})]:[],...r?[new r({rows:L,borders:{top:{size:0,color:"FFFFFF",style:i.BorderStyle?i.BorderStyle.NONE:void 0},left:{size:0,color:"FFFFFF",style:i.BorderStyle?i.BorderStyle.NONE:void 0},bottom:{size:0,color:"FFFFFF",style:i.BorderStyle?i.BorderStyle.NONE:void 0},right:{size:0,color:"FFFFFF",style:i.BorderStyle?i.BorderStyle.NONE:void 0},insideHorizontal:{size:0,color:"FFFFFF",style:i.BorderStyle?i.BorderStyle.NONE:void 0},insideVertical:{size:0,color:"FFFFFF",style:i.BorderStyle?i.BorderStyle.NONE:void 0}}})]:[new t({children:[new o({text:"Projeto:",bold:!0})]})]];for(let x=0;x<f.length;x++){const v=f[x],M=v.title||`Passo ${x+1}`,I=v.tag||"",F=v.description||"";if(h.push(new t({spacing:{before:240,after:120},children:[new o({text:M,bold:!0,size:26})]})),I&&h.push(new t({children:[new o({text:`Item clicado: ${I}`,italics:!0,size:20})]})),v.imageDataUrl){const N=await be(v.imageDataUrl),k=g(ue),z=g(pe),X=i.HorizontalPositionRelativeFrom&&i.HorizontalPositionAlign&&i.VerticalPositionRelativeFrom&&i.VerticalPositionAlign&&i.TextWrappingType?{horizontalPosition:{relative:i.HorizontalPositionRelativeFrom.MARGIN,align:i.HorizontalPositionAlign.CENTER},verticalPosition:{relative:i.VerticalPositionRelativeFrom.PARAGRAPH,align:i.VerticalPositionAlign.TOP},wrap:{type:i.TextWrappingType.SQUARE}}:void 0;h.push(new t({alignment:i.AlignmentType?i.AlignmentType.CENTER:void 0,children:[new a({data:N,transformation:{width:k,height:z},floating:X})]}))}F&&h.push(new t({spacing:{before:120},children:[new o({text:F,size:22})]}))}const S=new e({sections:[{properties:{page:{margin:{top:1440,right:1440,bottom:1440,left:1440}}},headers:{default:u?new u({children:O}):void 0},children:h}]}),$=await n.toBlob(S),P=URL.createObjectURL($),D=document.createElement("a");D.href=P,D.download=`homolog_${p.toISOString().slice(0,19).replace(/[:T]/g,"-")}.docx`,document.body.appendChild(D),D.click(),setTimeout(()=>{URL.revokeObjectURL(P),D.remove()},0),m("DOCX baixado")}catch(e){console.warn("Falha ao gerar DOCX editável:",e),m("Não foi possível gerar o DOCX editável")}}function Ee(){try{const e=new Date,n="",t=W,o=j,a="./assets/headerneo.JPG",r=f.map((p,w)=>{const y=B(p.title||`Passo ${w+1}`),T=B(p.description||""),g=B(p.tag||""),h=p.imageDataUrl||"";return`<article style="border:none;border-radius:8px;padding:10px;background:#fafafa;margin:10px 0;">
        <header>
          <h3 style="margin:0 0 6px;color:#111827;font-family:system-ui,Segoe UI,Roboto">${y}</h3>
          ${g?`<p style="margin:0 0 8px;color:#374151;font-size:12px">Item clicado: ${g}</p>`:""}
        </header>
        ${h?`<img src="${h}" alt="${y}" style="display:block;margin:6px auto;width:${t}cm;height:auto;max-height:${o}cm;border:none;border-radius:6px;object-fit:contain">`:""}
        ${T?`<p style="margin:8px 0;color:#1f2937">${T}</p>`:""}
      </article>`}).join(""),c=`<!doctype html><html lang="pt-BR"><head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>${B(n)}</title>
      <style>
        body{font-family:ui-sans-serif,system-ui,Segoe UI,Roboto;background:#ffffff;color:#111827;margin:20px}
        .docx-container{width:${t}cm;margin:0 auto}
        h1{font-size:20px;margin:0 0 12px}
        .hint{color:#6b7280;font-size:12px;margin-bottom:12px}
        .layout-header{margin:6px 0 14px}
        .brand{margin-bottom:6px}
        .brand-name{display:none}
        .meta-table{width:100%;border-collapse:collapse;font-size:12px;border:none}
        .meta-table th,.meta-table td{border:none;padding:6px;vertical-align:top}
      </style>
    </head><body>
      <div class="docx-container">
        <div class="layout-header">
          <div class="brand">
            <img src="${a}" alt="Header" style="width:100%;height:auto;border-radius:6px"/>
          </div>
          <table class="meta-table">
            <tr>
              <td><strong>Projeto:</strong> <span contenteditable="true"></span></td>
              <td><strong>Frente:</strong> <span contenteditable="true"></span></td>
            </tr>
            <tr>
              <td><strong>Distribuidora:</strong> <span contenteditable="true"></span></td>
              <td><strong>Responsável:</strong> <span contenteditable="true"></span></td>
            </tr>
            <tr>
              <td><strong>Produto/Serviço:</strong> <span contenteditable="true"></span></td>
              <td><strong>Data:</strong> <span contenteditable="true"></span></td>
            </tr>
            <tr>
              <td><strong>Resultado Esperado:</strong> <span contenteditable="true"></span></td>
              <td><strong>Versão:</strong> <span contenteditable="true"></span> &nbsp; | &nbsp; <strong>Navegador:</strong> <span contenteditable="true"></span></td>
            </tr>
          </table>
        </div>
        <section>
        
        ${r||"<p>Nenhum passo.</p>"}
        </section>
      </div>
    </body></html>`,d=new Blob([c],{type:"text/html;charset=utf-8"}),u=URL.createObjectURL(d),i=document.createElement("a");i.href=u,i.download=`homolog_${e.toISOString().slice(0,19).replace(/[:T]/g,"-")}.html`,document.body.appendChild(i),i.click(),setTimeout(()=>{URL.revokeObjectURL(u),i.remove()},0),m("HTML baixado")}catch(e){console.warn("Falha ao baixar HTML:",e),m("Não foi possível gerar o HTML")}}s.start.addEventListener("click",me);s.stop.addEventListener("click",te);s.add.addEventListener("click",oe);s.downloadHtml&&s.downloadHtml.addEventListener("click",Ee);async function ae(){try{let e=we();const n=new Date;if(!window.htmlDocx||typeof window.htmlDocx.asBlob!="function"){m("Biblioteca DOCX não carregada");return}try{const r=await ye("./assets/headerneo.JPG");e=e.replace("./assets/headerneo.JPG",r)}catch{}const t=window.htmlDocx.asBlob(e,{orientation:"portrait"}),o=URL.createObjectURL(t),a=document.createElement("a");a.href=o,a.download=`homolog_${n.toISOString().slice(0,19).replace(/[:T]/g,"-")}.docx`,document.body.appendChild(a),a.click(),setTimeout(()=>{URL.revokeObjectURL(o),a.remove()},0),m("DOCX baixado")}catch(e){console.warn("Falha ao gerar DOCX:",e),m("Não foi possível gerar o DOCX")}}s.downloadDocx&&s.downloadDocx.addEventListener("click",()=>{window.docx?ve():ae()});s.toggleExpand&&(s.toggleExpand.addEventListener("click",Ce),document.addEventListener("fullscreenchange",Me));s.clear.addEventListener("click",()=>{confirm("Tem certeza que deseja limpar todos os passos?")&&fe()});s.video.addEventListener("click",e=>{if(!C){m("Inicie a captura para criar passos");return}const n=Se(e.clientX,e.clientY);if(!n){m("Clique dentro do vídeo");return}re(n)});ge();H();Pe();function Ce(){try{!document.fullscreenElement&&s.videoWrapper?.requestFullscreen?s.videoWrapper.requestFullscreen():document.exitFullscreen&&document.exitFullscreen()}catch(e){console.warn("Falha ao alternar fullscreen:",e),m("Não foi possível alternar tela cheia")}}function Me(){if(!s.toggleExpand)return;const e=!!document.fullscreenElement;s.toggleExpand.textContent=e?"Retrair captura":"Expandir captura",s.toggleExpand.setAttribute("aria-expanded",String(e))}let _=null;function Ie(e){if(!s.imageModal||!s.modalImage)return;s.modalImage.src=e,s.imageModal.classList.remove("hidden"),s.imageModal.setAttribute("aria-hidden","false"),_=document.activeElement;try{s.imageModal.focus()}catch{}s.imageModal.addEventListener("click",q,{once:!0});const n=t=>{t.key==="Escape"&&q()};document.addEventListener("keydown",n,{once:!0})}function q(){if(s.imageModal){s.imageModal.classList.add("hidden"),s.imageModal.setAttribute("aria-hidden","true");try{_&&typeof _.focus=="function"&&_.focus()}catch{}}}function Te(e,n,t,o=18){const a=o,r=e.createRadialGradient(n,t,a*.35,n,t,a*1.6);r.addColorStop(0,"rgba(239,68,68,0.35)"),r.addColorStop(1,"rgba(239,68,68,0)"),e.fillStyle=r,e.beginPath(),e.arc(n,t,a*1.6,0,Math.PI*2),e.fill();const c=a*1.7,d=c*.58,u=c*.5,i=c*.9,p=Math.max(2,Math.round(c*.14)),w=-Math.PI/4,y=Math.cos(w),T=Math.sin(w),g=(b,L)=>({x:n+b*y-L*T,y:t+b*T+L*y}),h=[g(0,0),g(-u/2,d),g(-p/2,d),g(-p/2,d+i),g(p/2,d+i),g(p/2,d),g(u/2,d)];e.fillStyle="rgba(239,68,68,1)",e.beginPath(),e.moveTo(h[0].x,h[0].y);for(let b=1;b<h.length;b++)e.lineTo(h[b].x,h[b].y);e.closePath(),e.fill(),e.strokeStyle="rgba(220,38,38,1)",e.lineWidth=Math.max(2,Math.round(a*.16)),e.lineJoin="round",e.stroke()}function Se(e,n){const t=s.video,o=t.getBoundingClientRect(),a=e-o.left,r=n-o.top;if(a<0||r<0||a>o.width||r>o.height)return null;const c=t.videoWidth/o.width,d=t.videoHeight/o.height;return{x:Math.round(a*c),y:Math.round(r*d)}}async function re(e){await G();const n=ne(e);if(!n)return;const t=`step_${Date.now()}`,o=`Clicado no ponto (${e.x}, ${e.y})`,a={id:t,title:o,description:"",imageDataUrl:n,createdAt:Date.now()};f.push(a),H(),U(),m("Passo criado pelo clique");const r=await De(e).catch(()=>null),c=Be(r);c?(R(t,"title",c),R(t,"tag",c),R(t,"description",J(c,e)),H(),m(`Clicado em ${c}`)):(R(t,"description",J(null,e)),H(),m(o))}function De(e){return new Promise(n=>{try{const t=s.video;if(!t||!t.videoWidth||!t.videoHeight)return n(null);const o=t.videoWidth,a=t.videoHeight,r=document.createElement("canvas");r.width=o,r.height=a,r.getContext("2d").drawImage(t,0,0,o,a);const d=Math.max(180,Math.round(o*.22)),u=Math.max(100,Math.round(a*.16)),i=Math.max(0,Math.min(o-d,e.x-Math.round(d/2))),p=Math.max(0,Math.min(a-u,e.y-Math.round(u/2))),w=document.createElement("canvas");w.width=d,w.height=u,w.getContext("2d").drawImage(r,i,p,d,u,0,0,d,u);const T=w.toDataURL("image/png",.92);if(!window.Tesseract||!window.Tesseract.recognize)return n(null);const g=e.x-i,h=e.y-p;window.Tesseract.recognize(T,"por+eng").then(b=>{const L=b?.data,O=Array.isArray(L?.words)?L.words:[],S=l=>l?.bbox||l?.boundingBox||l?.box,$=l=>l?.x0??l?.left??l?.x??0,P=l=>l?.y0??l?.top??l?.y??0,D=l=>l?.x1??(l?.left??0)+(l?.width??0),x=l=>l?.y1??(l?.top??0)+(l?.height??0);let v=null;for(const l of O){const E=S(l);if(E&&g>=$(E)&&g<=D(E)&&h>=P(E)&&h<=x(E)){v=l;break}}if(!v&&O.length){let l=1/0;for(const E of O){const A=S(E);if(!A)continue;const ce=($(A)+D(A))/2,le=(P(A)+x(A))/2,V=Math.hypot(ce-g,le-h);V<l&&(l=V,v=E)}}if(!v)return n(null);const M=S(v),I=P(M),F=x(M),N=Math.max(4,Math.round((F-I)*.6)),k=I-N,z=F+N,ie=O.filter(l=>{const E=S(l);return E?Math.min(x(E),z)-Math.max(P(E),k)>0:!1}).sort((l,E)=>$(S(l))-$(S(E))).map(l=>String(l?.text||"").trim()).filter(Boolean).join(" ").trim(),se=String(v?.text||"").trim(),de=Fe(ie||se);n(de||null)}).catch(b=>{console.warn("OCR falhou:",b),n(null)})}catch(t){console.warn("Sugestão de título falhou:",t),n(null)}})}function Fe(e){if(!e)return null;const n=String(e).replace(/\s+/g," ").trim();if(n.length<=80)return n;const t=n.slice(0,80),o=t.lastIndexOf(" ");return o>40?t.slice(0,o):t}function Be(e){if(!e)return null;const n=e.trim();return n||null}function J(e,n){const o=n&&typeof n.x=="number"&&typeof n.y=="number"?` (${n.x}, ${n.y})`:"";return e?`Clique no item "${e}"${o} para executar a ação pretendida. Descreva o objetivo, os passos e o resultado esperado.`:`Clique na área indicada${o}. Descreva o objetivo, os passos e o resultado esperado.`}let Y=0;function Le(){const e=window.location.origin||"";return e.includes("localhost:8010")||e.includes("127.0.0.1:8010")?"":"http://localhost:8010"}function Pe(){const e=Le();setInterval(async()=>{try{const n=await fetch(`${e}/trigger-state`);if(!n.ok)return;const t=await n.json().catch(()=>null),o=t&&t.ts||0;if(o&&o>Y){Y=o;const a=t&&typeof t.x=="number"?t.x:null,r=t&&typeof t.y=="number"?t.y:null,c=C&&C.getVideoTracks&&C.getVideoTracks()[0],d=c&&typeof c.getSettings=="function"?c.getSettings():{};(d&&d.displaySurface)==="monitor"&&a!=null&&r!=null?await re({x:a,y:r}):await oe()}}catch{}},1e3)}
